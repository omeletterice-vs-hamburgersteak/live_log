<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>„É©„Ç§„ÉñÂèÇÊà¶Ë®òÈå≤„Ç¢„Éó„É™</title>
  <!-- „Åì„Åì„Å´CSS„ÇÑJS„ÅÆ„É™„É≥„ÇØ„ÇíËøΩÂä† -->
</head>
<body>
  <div class="container mx-auto p-4 bg-[#FFF0F5]">
    <h1 class="text-3xl text-center font-kaisei text-[#663300] mb-4">ÂèÇÊà¶„Åó„Åü„É©„Ç§„Éñ„Éª„Ç§„Éô„É≥„Éà‰∏ÄË¶ß</h1>

    <div class="mb-2">
      <span id="artist-toggle" class="cursor-pointer font-bold">
        Âá∫ÊºîËÄÖ„ÅßÁµû„ÇäËæº„Åø üîª
      </span>

      <div id="artist-filter" class="hidden mt-2">
        <% @artists.each do |artist| %>
          <%= link_to artist.name,
              live_events_path(artist_id: artist.id),
              class: "block px-2 py-1 hover:bg-gray-200" %>
        <% end %>
      </div>
    </div>

    <table class="table-auto w-full border-collapse border border-gray-300 mt-4">
      <thead>
        <tr class="text-[#663300]">
          <% current_sort = params[:sort] || "date" %>
          <% current_direction = params[:direction] || "asc" %>
          <th class="border border-gray-300 px-2 py-1">
            <% current_direction = params[:direction] == "desc" ? "desc" : "asc" %>
            <% next_direction = current_sort == "title" && current_direction == "asc" ? "desc" : "asc" %>

            <%= link_to root_path(sort: "title", direction: next_direction), class: "inline-flex items-center #{'text-blue-600 font-bold' if current_sort == 'title'}" do %>
              „Çø„Ç§„Éà„É´
              <% if current_direction == "asc" %>
                ‚ñ≤
              <% else %>
                ‚ñº
              <% end %>
            <% end %>
          </th>
          <th class="border border-gray-300 px-2 py-1">
            <% current_direction = params[:direction] == "desc" ? "desc" : "asc" %>
            <% next_direction = current_sort == "date" && current_direction == "asc" ? "desc" : "asc" %>

            <%= link_to root_path(sort: "date", direction: next_direction), class: "inline-flex items-center #{'text-blue-600 font-bold' if current_sort == 'date'}" do %>
              ÈñãÂÇ¨Êó•
              <% if current_direction == "asc" %>
                ‚ñ≤
              <% else %>
                ‚ñº
              <% end %>
            <% end %>
          </th>
          <th class="border border-gray-300 px-2 py-1">
            <span id="artist-toggle" class="cursor-pointer">
              Âá∫ÊºîËÄÖ ‚ñº
            </span>
          </th>
          <th class="border border-gray-300 px-2 py-1">
            <% current_direction = params[:direction] == "desc" ? "desc" : "asc" %>
            <% next_direction = current_sort == "venue" && current_direction == "asc" ? "desc" : "asc" %>

            <%= link_to root_path(sort: "venue", direction: next_direction), class: "inline-flex items-center #{'text-blue-600 font-bold' if current_sort == 'venue'}" do %>
              ‰ºöÂ†¥
              <% if current_direction == "asc" %>
                ‚ñ≤
              <% else %>
                ‚ñº
              <% end %>
            <% end %>
          </th>
          
          <th class="border border-gray-300 px-2 py-1">Êìç‰Ωú</th>
        </tr>
      </thead>
      <tbody>
        <% @live_events.order(created_at: :desc).each do |event| %>
          <tr>
            <td class="border border-gray-300 px-2 py-1"><%= link_to event.title, live_event_path(event) %></td>
            <td class="border border-gray-300 px-2 py-1"><%= event.date.strftime("%Y-%m-%d") %></td>
            <td class="border border-gray-300 px-2 py-1"><%= event.artist_id %></td>
            <td class="border border-gray-300 px-2 py-1"><%= event.venue %></td>
            <td class="border border-gray-300 px-2 py-1">
              <%= link_to "Á∑®ÈõÜ", edit_live_event_path(event), class: "text-green-600 hover:underline mr-2" %>
              <%= link_to "ÂâäÈô§", live_event_path(event), 
                  data: { turbo_method: :delete, turbo_confirm: "Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü"}, class: "text-red-600 hover:underline" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <div class="mt-6 text-right">
      <%= link_to "Êñ∞„Åó„ÅÑ„É©„Ç§„Éñ„ÇíËøΩÂä†", new_live_event_path, class: "bg-[#6a5acd] hover:bg-[#7b68ee] text-white font-bold py-2 px-4 rounded" %>
    </div>
  </div>
</body>
</html>
